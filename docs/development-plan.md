# VS Code Sidebar Terminal Extension 開発プラン

## プロジェクト概要
GitHub Copilotのように右ペインにターミナルを表示するVS Code拡張機能を開発します。VS Codeの既存ターミナルを使用し、縦分割機能も実装します。

## 開発ステップ

### フェーズ1: 基本機能の実装と安定化 (完了済み)

- **1. プロジェクトセットアップ**: 開発環境の準備と依存関係のインストール。
- **2. 基本構成ファイル作成**: 拡張機能の基本構造とWebViewの初期設定。
- **3. Sidebar Terminal View実装**: サイドパネルへのターミナル表示、xterm.jsとnode-ptyの統合。
- **4. 分割機能実装**: ターミナルの縦分割、複数ターミナル管理、レイアウト管理。
- **5. セキュリティ・パフォーマンス初期最適化**: Content Security Policy設定、基本的なメッセージ通信、リソース管理。
- **6. テスト・デバッグ**: 初期テストスイートの作成とデバッグ環境の確立。

### フェーズ2: 高度な機能とアーキテクチャ改善 (進行中/完了済み)

- **7. Alt+Click カーソルポジショニング**: VS Code標準のAlt+Click機能の実装と、Claude Code検出との連携。
- **8. Claude Code 検出と最適化**: AIインタラクション中のパフォーマンス最適化と競合解決。
- **9. WebView アーキテクチャのリファクタリング**: モノリシックな`main.ts`から、9つの特化したマネージャー（Performance, ClaudeCode, Input, UI, Config, Message, Notification, Split, TerminalCoordinator）によるモジュラーアーキテクチャへの移行。これにより、コードの整理、保守性、パフォーマンスが大幅に向上。

### フェーズ3: さらなる機能強化と品質向上 (計画中)

- **10. 強化されたテスト**: WebViewコンポーネントのテスト（SplitManager, HeaderManager, SettingsPanel）、パフォーマンス、アクセシビリティ、ロードテストフレームワークの導入。
- **11. ユーザーエクスペリエンスの向上**: ターミナルセッションの永続化、カスタムテーマ、拡張されたキーボードショートカット、ターミナル履歴管理。
- **12. その他の機能強化**: (必要に応じて追加)

## 技術スタック
- **言語**: TypeScript
- **フレームワーク**: VS Code Extension API
- **ライブラリ**: 
  - xterm.js (ターミナルエミュレータ)
  - node-pty (PTYプロセス管理)
- **開発ツール**: 
  - yo code (スキャフォールディング)
  - vsce (パッケージング)

## 成果物
- VS Code拡張機能パッケージ (.vsix)
- ソースコード
- ドキュメント
- テストスイート

## 想定課題と対策

1.  **セキュリティ**: Content Security Policyの適切な設定、メッセージ検証、リソース制限により、初期のセキュリティ課題は解決済み。継続的なセキュリティテストを実施。
2.  **パフォーマンス**: 複数ターミナルによるメモリ使用量の管理、出力バッファリング、デバウンス処理、Claude Code検出時の最適化により、パフォーマンスは大幅に改善。さらなる最適化は継続的な課題。
3.  **互換性**: 異なるOS環境でのターミナル動作の統一はnode-ptyとプラットフォーム固有ビルドにより実現済み。IMEサポートも強化。
4.  **UI/UX**: 直感的な分割操作とレイアウト管理は実装済み。Alt+Click機能や視覚的なフィードバックによりUXを向上。今後のユーザーエクスペリエンス向上は継続的な課題。

## 次のステップ

現在の開発フェーズに基づき、以下のステップに注力します。

-   **WebViewコンポーネントのテスト完了**: SplitManager, HeaderManager, SettingsPanelなど、WebViewの主要コンポーネントに対するテストカバレッジを向上させます。
-   **パフォーマンス、アクセシビリティ、ロードテストの導入**: より堅牢なテストフレームワークを構築し、拡張機能の品質を多角的に評価します。
-   **ユーザーエクスペリエンスの継続的な向上**: ターミナルセッションの永続化、カスタムテーマ、拡張されたキーボードショートカット、ターミナル履歴管理など、ユーザーからのフィードバックに基づいた機能強化を検討します。